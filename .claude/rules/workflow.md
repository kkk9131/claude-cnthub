# 2-Agent ワークフロールール

## 役割分担

### Cursor (PM)
- 計画策定・タスク作成
- コードレビュー・品質管理
- 本番デプロイ判断
- ユーザーとのコミュニケーション

### Claude Code (Worker)
- コード実装・テスト作成
- バグ修正・リファクタリング
- staging 環境での検証
- 技術調査・ドキュメント更新

## マーカー運用

### 状態遷移

```
pm:TODO → cc:TODO → cc:WIP → cc:完了 → pm:レビュー中 → pm:承認
   ↑                    ↓
   └── 修正依頼 ←───────┘
```

### マーカー説明

| マーカー | 状態 | 担当 | 次のアクション |
|---------|------|------|---------------|
| `pm:TODO` | 計画中 | PM | タスク詳細を記述 → `cc:TODO` |
| `cc:TODO` | 実装待ち | Worker | `/work` で着手 → `cc:WIP` |
| `cc:WIP` | 実装中 | Worker | 完了したら → `cc:完了` |
| `cc:完了` | 実装完了 | Worker | PM のレビュー待ち |
| `pm:レビュー中` | レビュー中 | PM | 承認/修正依頼 |
| `pm:承認` | 承認済み | PM | マージ・デプロイ可能 |
| `cc:blocked` | ブロック中 | Worker | ブロック理由を記載 |

## ハンドオフ規則

### PM → Worker

1. タスク ID と完了条件を明確に
2. 関連ドキュメントを参照
3. ブランチ名を指定
4. Plans.md を `cc:TODO` に更新

### Worker → PM

1. 変更ファイル一覧を報告
2. テスト結果を報告
3. 実装メモ・注意点を記載
4. Plans.md を `cc:完了` に更新

## 禁止事項

- Worker が本番デプロイを実行
- PM が直接コードを書く（緊急時を除く）
- マーカーをスキップした状態遷移
- レビューなしのマージ

# TASKS.md - ä¸¦åˆ—å®Ÿè£…ã‚¿ã‚¹ã‚¯ä¸€è¦§

> git worktree ã«ã‚ˆã‚‹ä¸¦åˆ—é–‹ç™ºç”¨ã‚¿ã‚¹ã‚¯ãƒã‚±ãƒƒãƒˆ
> æœ€çµ‚æ›´æ–°: 2026-01-02
> è¦ä»¶å®šç¾©: [07-plugin-requirements.md](./Agent-docs/07-plugin-requirements.md)

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

```bash
# 1. ãƒ–ãƒ©ãƒ³ãƒä½œæˆ
git branch feature/posttooluse-hook
git branch feature/sessionend-summary
git branch feature/cmd-get

# 2. worktree ä½œæˆï¼ˆåˆ¥ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ä¸¦åˆ—ä½œæ¥­ï¼‰
git worktree add ../cnthub-posttooluse feature/posttooluse-hook
git worktree add ../cnthub-sessionend feature/sessionend-summary
git worktree add ../cnthub-cmd-get feature/cmd-get

# 3. å„ worktree ã§ä½œæ¥­
cd ../cnthub-posttooluse && bun install
cd ../cnthub-sessionend && bun install
cd ../cnthub-cmd-get && bun install
```

---

## å®Œäº†æ¸ˆã¿

<details>
<summary>å®Œäº†æ¸ˆã¿ã‚¿ã‚¹ã‚¯ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§å±•é–‹ï¼‰</summary>

### åŸºç›¤ãƒ»ã‚³ã‚¢æ©Ÿèƒ½ âœ…
- [x] I-01: ã‚µãƒ¼ãƒãƒ¼çµ±åˆ (Port 3048)
- [x] I-02: Memory API ã‚·ãƒ³ãƒ—ãƒ«åŒ–
- [x] I-03: æ–°ã‚»ãƒƒã‚·ãƒ§ãƒ³ ID ä½“ç³» (`ch_ss_0001`)
- [x] I-04: ãƒ­ãƒ¼ã‚«ãƒ« Embedding ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
- [x] P-01: Project å‹å®šç¾©ãƒ»DB ã‚¹ã‚­ãƒ¼ãƒ
- [x] P-02: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ CRUD API
- [x] P-03: ã‚»ãƒƒã‚·ãƒ§ãƒ³â†’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè‡ªå‹•ç´ä»˜ã‘

</details>

---

## Phase 1: Plugin æ©Ÿèƒ½å®Ÿè£… `ç¾åœ¨`

### ğŸ”´ 1-A: Hook å®Ÿè£…ï¼ˆé«˜å„ªå…ˆåº¦ãƒ»ä¾å­˜ãªã—ï¼‰

#### H-01: PostToolUse Hookï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¦³æ¸¬è¨˜éŒ²ï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ–ãƒ©ãƒ³ãƒ | `feature/posttooluse-hook` |
| ä¾å­˜ | ãªã— |
| è¦ä»¶ID | R-02 |

**å®Ÿè£…å†…å®¹:**
```
plugin/scripts/post-tooluse-hook.js  # æ–°è¦ä½œæˆ
plugin/hooks/hooks.json              # PostToolUse è¿½åŠ 
packages/api/src/routes/hooks.ts     # POST /hook/post-tooluse
```

**å®Œäº†æ¡ä»¶:**
- [ ] PostToolUse Hook ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ
- [ ] hooks.json ã« PostToolUse è¨­å®šè¿½åŠ 
- [ ] observations ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¨˜éŒ²

---

#### H-02: SessionEnd è¦ç´„â†’ã‚¿ã‚¤ãƒˆãƒ«â†’Embedding é€£é–ç”Ÿæˆ

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ–ãƒ©ãƒ³ãƒ | `feature/sessionend-summary` |
| ä¾å­˜ | ãªã— |
| è¦ä»¶ID | R-01, R-04, R-05 |

**å®Ÿè£…å†…å®¹:**
```
plugin/scripts/session-end-hook.js   # æ‹¡å¼µ
packages/api/src/routes/hooks.ts     # session-end å‡¦ç†è¿½åŠ 
packages/api/src/services/           # è¦ç´„ãƒ»ã‚¿ã‚¤ãƒˆãƒ«ãƒ»Embeddingé€£é–
```

**å®Œäº†æ¡ä»¶:**
- [ ] ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆèª­ã¿è¾¼ã¿
- [ ] Claude AI ã§è¦ç´„ + ã‚¿ã‚¤ãƒˆãƒ«ç”Ÿæˆ
- [ ] Transformers.js ã§ Embedding ç”Ÿæˆ
- [ ] DB ä¿å­˜ï¼ˆsummaries, embeddingsï¼‰

---

#### H-03: SessionStart ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæ³¨å…¥

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ–ãƒ©ãƒ³ãƒ | `feature/sessionstart-inject` |
| ä¾å­˜ | H-02 |
| è¦ä»¶ID | R-07 |

**å®Ÿè£…å†…å®¹:**
```
plugin/scripts/session-start-hook.js  # æ‹¡å¼µ
packages/api/src/routes/hooks.ts      # é–¢é€£ã‚»ãƒƒã‚·ãƒ§ãƒ³æ¤œç´¢
```

**å®Œäº†æ¡ä»¶:**
- [ ] sqlite-vec ã§ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢
- [ ] é–¢é€£ã‚»ãƒƒã‚·ãƒ§ãƒ³è¦ç´„ã‚’ stdout ã«å‡ºåŠ›
- [ ] Claude ã«è‡ªå‹•æ³¨å…¥

---

### ğŸŸ¡ 1-B: ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚³ãƒãƒ³ãƒ‰ï¼ˆé«˜å„ªå…ˆåº¦ï¼‰

#### CMD-01: /cnthub:get - éå»ã‚»ãƒƒã‚·ãƒ§ãƒ³å–å¾—

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ–ãƒ©ãƒ³ãƒ | `feature/cmd-get` |
| ä¾å­˜ | ãªã— |
| è¦ä»¶ID | R-08 |

**å®Ÿè£…å†…å®¹:**
```
plugin/commands/cnthub-get.md        # ã‚³ãƒãƒ³ãƒ‰å®šç¾©
packages/api/src/routes/commands.ts  # ã‚³ãƒãƒ³ãƒ‰ç”¨ APIï¼ˆä»»æ„ï¼‰
```

**ãƒ•ãƒ­ãƒ¼:**
```
1. ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§ã‚’ãƒªã‚¹ãƒˆè¡¨ç¤ºï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/æ—¥ä»˜ãƒ•ã‚£ãƒ«ã‚¿ï¼‰
2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé¸æŠ
3. é¸æŠã‚»ãƒƒã‚·ãƒ§ãƒ³ã®è¦ç´„ã‚’ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«æ³¨å…¥
```

**å®Œäº†æ¡ä»¶:**
- [ ] ã‚³ãƒãƒ³ãƒ‰å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
- [ ] ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§å–å¾—ãƒ­ã‚¸ãƒƒã‚¯
- [ ] é¸æŠ UIï¼ˆãƒªã‚¹ãƒˆãƒ™ãƒ¼ã‚¹ï¼‰
- [ ] ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæ³¨å…¥

---

#### CMD-02: /cnthub:export - ç¾åœ¨ã‚»ãƒƒã‚·ãƒ§ãƒ³æ›¸ãå‡ºã—

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ–ãƒ©ãƒ³ãƒ | `feature/cmd-export` |
| ä¾å­˜ | H-01ï¼ˆPostToolUse ã§è¦³æ¸¬ãƒ‡ãƒ¼ã‚¿ãŒå¿…è¦ï¼‰ |
| è¦ä»¶ID | R-09 |

**å®Ÿè£…å†…å®¹:**
```
plugin/commands/cnthub-export.md     # ã‚³ãƒãƒ³ãƒ‰å®šç¾©
packages/api/src/routes/commands.ts  # ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ API
```

**ãƒ•ãƒ­ãƒ¼:**
```
1. ç¾åœ¨ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®è¦³æ¸¬è¨˜éŒ²ï¼ˆobservationsï¼‰ã‚’å–å¾—
2. AI ãŒã‚°ãƒ«ãƒ¼ãƒ—åˆ†ã‘æ¡ˆã‚’æç¤º
3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé¸æŠ
4. é¸æŠã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¦ç´„â†’Embeddingâ†’DBä¿å­˜
```

**å®Œäº†æ¡ä»¶:**
- [ ] ã‚³ãƒãƒ³ãƒ‰å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
- [ ] è¦³æ¸¬è¨˜éŒ²å–å¾—ãƒ­ã‚¸ãƒƒã‚¯
- [ ] AI ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ã‘
- [ ] é¸æŠâ†’è¦ç´„â†’ä¿å­˜ãƒ•ãƒ­ãƒ¼

---

### ğŸŸ¢ 1-C: Viewer UIï¼ˆä¸­å„ªå…ˆåº¦ï¼‰

#### V-01: Viewer UI åŸºç›¤

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ–ãƒ©ãƒ³ãƒ | `feature/viewer-base` |
| ä¾å­˜ | ãªã— |
| è¦ä»¶ID | R-10 |

**å®Ÿè£…å†…å®¹:**
```
plugin/ui/                           # packages/web/ ã‹ã‚‰ç§»è¡Œ
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ App.tsx
â”‚   â”œâ”€â”€ components/
â”‚   â””â”€â”€ pages/
â””â”€â”€ package.json
```

**å®Œäº†æ¡ä»¶:**
- [ ] packages/web/ ã‚’ plugin/ui/ ã«ç§»è¡Œ
- [ ] localhost:3048/viewer ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- [ ] åŸºæœ¬ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆã‚µã‚¤ãƒ‰ãƒãƒ¼ + ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢ï¼‰

---

#### V-02: ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ‡æ›¿ï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ–ãƒ©ãƒ³ãƒ | `feature/viewer-sidebar` |
| ä¾å­˜ | V-01 |
| è¦ä»¶ID | R-11 |

**å®Ÿè£…å†…å®¹:**
```
plugin/ui/src/components/
â”œâ”€â”€ Sidebar/
â”‚   â”œâ”€â”€ SessionList.tsx
â”‚   â””â”€â”€ ProjectSwitcher.tsx
```

**å®Œäº†æ¡ä»¶:**
- [ ] IDEé¢¨ã‚µã‚¤ãƒ‰ãƒãƒ¼
- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ‡æ›¿ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³
- [ ] ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§ï¼ˆæ—¥ä»˜ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ï¼‰

---

#### V-03: ãƒãƒ¼ãƒ‰ã‚¨ãƒ‡ã‚£ã‚¿ï¼ˆget/export æ“ä½œï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ–ãƒ©ãƒ³ãƒ | `feature/viewer-node-editor` |
| ä¾å­˜ | V-01, V-02 |
| è¦ä»¶ID | R-12 |

**å®Ÿè£…å†…å®¹:**
```
plugin/ui/src/components/
â”œâ”€â”€ NodeEditor/
â”‚   â”œâ”€â”€ NodeEditor.tsx      # React Flow ãƒ™ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ SessionNode.tsx
â”‚   â””â”€â”€ ConnectionLine.tsx
```

**å®Œäº†æ¡ä»¶:**
- [ ] React Flow ã§ãƒãƒ¼ãƒ‰ã‚¨ãƒ‡ã‚£ã‚¿
- [ ] ä¸­å¤®ã«ç¾åœ¨ã‚»ãƒƒã‚·ãƒ§ãƒ³
- [ ] D&D ã§æ¥ç¶š = get æ“ä½œ
- [ ] æ¥ç¶šå‰Šé™¤ = export æ“ä½œ

---

## å‰Šé™¤äºˆå®š

<details>
<summary>ä¸è¦ã«ãªã£ãŸã‚¿ã‚¹ã‚¯ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§å±•é–‹ï¼‰</summary>

ä»¥ä¸‹ã¯è¦ä»¶å†å®šç¾©ã«ã‚ˆã‚Šä¸è¦ã«ãªã£ãŸã‚¿ã‚¹ã‚¯:

### æ—§ GUI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ (G-01ã€œ04)
> Viewer UI ã§ React Flow ãƒ™ãƒ¼ã‚¹ã«å†å®Ÿè£…ã™ã‚‹ãŸã‚ä¸è¦

- ~~G-01: ãƒ„ãƒªãƒ¼ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ~~
- ~~G-02: ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—åŸºç›¤~~
- ~~G-03: ãƒãƒ¼ã‚¸æ“ä½œ UI~~
- ~~G-04: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ‡æ›¿ UI~~

### æ—§ Skills (S-01ã€œ03)
> CMD-01, CMD-02 ã«ç½®ãæ›ãˆ

- ~~S-01: cnthub:add Skill å®šç¾©~~
- ~~S-02: cnthub:search Skill å®šç¾©~~
- ~~S-03: cnthub:gui Skill å®šç¾©~~

### CLI (C-01ã€œ04)
> Plugin å‹•ä½œã«ä¸è¦ã€å°†æ¥ã®æ‹¡å¼µã¨ã—ã¦ä¿ç•™

- ~~C-01: CLI ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åˆæœŸåŒ–~~
- ~~C-02: `cnthub list`~~
- ~~C-03: `cnthub search`~~
- ~~C-04: `cnthub merge`~~

### æ—§ UI çµ±åˆã‚¿ã‚¹ã‚¯ (UI-01ã€œ03)
> packages/web/ ã‚’ plugin/ui/ ã«çµ±åˆã™ã‚‹ãŸã‚ä¸è¦

- ~~UI-01: TreeView ã‚’ SessionList ã«çµ±åˆ~~
- ~~UI-02: ProjectSwitcher ã‚’ Sidebar ã«çµ±åˆ~~
- ~~UI-03: DnD + MergeUI ã‚’ã‚»ãƒƒã‚·ãƒ§ãƒ³ç”»é¢ã«çµ±åˆ~~

</details>

---

## Phase 2: Cross-LLM é€£æº `å°†æ¥`

<details>
<summary>Phase 2 ã‚¿ã‚¹ã‚¯ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§å±•é–‹ï¼‰</summary>

### Profile System
| ID | ã‚¿ã‚¹ã‚¯ | ä¾å­˜ |
|----|--------|------|
| PF-01 | project_profiles ãƒ†ãƒ¼ãƒ–ãƒ« | P-01 |
| PF-02 | Static/Dynamic Facts API | PF-01 |
| PF-03 | Dynamic Facts è‡ªå‹•æ›´æ–° | PF-02 |

### LLM æ¥ç¶š
| ID | ã‚¿ã‚¹ã‚¯ | ä¾å­˜ |
|----|--------|------|
| L-01 | LLM æ¥ç¶šè¨­å®š DB ã‚¹ã‚­ãƒ¼ãƒ | - |
| L-02 | ChatGPT Adapter | L-01 |
| L-03 | Codex Adapter | L-01 |
| L-04 | æ¥ç¶šç®¡ç† API | L-01 |

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆè»¢é€ UI
| ID | ã‚¿ã‚¹ã‚¯ | ä¾å­˜ |
|----|--------|------|
| T-01 | LLM æ¥ç¶šç®¡ç†ãƒšãƒ¼ã‚¸ | L-04 |
| T-02 | ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆè»¢é€ãƒšãƒ¼ã‚¸ | T-01, PF-02 |
| T-03 | ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»ç·¨é›† | T-02 |

</details>

---

## é€²æ—ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°

```
Phase 1: Plugin æ©Ÿèƒ½å®Ÿè£…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1-A Hook å®Ÿè£…:     â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0/3
1-B ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚³ãƒãƒ³ãƒ‰: â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0/2
1-C Viewer UI:     â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0/3
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Phase 1 Total:     â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0/8

# æ¬¡ã®å„ªå…ˆã‚¿ã‚¹ã‚¯
1. H-01 - PostToolUse Hookï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¦³æ¸¬è¨˜éŒ²ï¼‰
2. H-02 - SessionEnd è¦ç´„â†’ã‚¿ã‚¤ãƒˆãƒ«â†’Embedding é€£é–ç”Ÿæˆ
3. H-03 - SessionStart ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæ³¨å…¥
4. CMD-01 - /cnthub:get ã‚³ãƒãƒ³ãƒ‰
5. CMD-02 - /cnthub:export ã‚³ãƒãƒ³ãƒ‰
```

---
name: cnthub:export
description: 現在のセッションの観測をエクスポート
---

# /cnthub:export

現在のセッションの観測を論理グループに分類し、新規セッションとしてエクスポートする。

## MCP ツール

- `list_observations` - 観測一覧取得 (`sessionId: "current"`)
- `export_observations` - グループをエクスポート

## ワークフロー

1. 現在のセッションから観測を取得
2. 論理グループに分類して表示
3. ユーザーがグループを選択
4. 選択されたグループをエクスポート
5. コンテキスト削除の確認

## 出力フォーマット

### グループ表示

```markdown
## エクスポート: 現在のセッション観測

{N}件の観測を分析し、{M}個のグループを特定しました:

### 検出されたグループ

1. **{グループ名}** ({N}件の観測)
   - {観測ID}: {説明}

---

**エクスポートするグループを選択** (例: "1", "1,3", "all"):
```

### エクスポート完了

```markdown
## エクスポート完了

{N}グループを新規セッションとしてエクスポートしました:

### 1. {グループ名}
- **セッションID**: ch_ss_XXXX
- **観測数**: X件
- **要約**: {AI生成の要約}

---

`/clear` 後に `/cnthub:get last` で素早く取得できます。
```

### コンテキスト管理確認

```markdown
## コンテキスト管理

エクスポートした観測をコンテキストから削除しますか？

- **はい**: 残りのコンテキストを保存し、`/clear` 後に自動復元
- **いいえ**: 現在のコンテキストを維持（コピーのみ）
```

### コンテキスト保存完了 (はい)

```markdown
## コンテキスト保存完了

残りのコンテキスト（{N}件の観測）を保存しました。

**次のステップ:**
1. `/clear` でコンテキストをリセット
2. 次のメッセージで残りのコンテキストが自動復元されます

`/clear` 後に `/cnthub:get last` でエクスポートしたセッションを取得できます。
```

### エクスポートのみ (いいえ)

```markdown
## エクスポート完了

観測を新規セッションにコピーしました。現在のコンテキストは変更されていません。
```

## コンテキスト保存API

「はい」選択時、残りの観測を保存:

```bash
POST http://localhost:3048/api/inject/pending
{ "sessionId": "<session_id>", "context": "<formatted_context>" }
```

## エラー

- 観測なし: 「現在のセッションに観測がありません。」
- API利用不可: 「cnthub APIが利用できません。」
- エクスポート失敗: 「グループ '{名前}' のエクスポートに失敗しました。」
- キャンセル: 「エクスポートをキャンセルしました。」
